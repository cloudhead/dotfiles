pkgname=spectrwm-git
pkgver=3.4.1
pkgrel=1
pkgdesc="A minimalistic automatic tiling window manager that tries to stay out of the way."
arch=('x86_64' 'i686')
url="http://www.spectrwm.org"
license=('custom:ISC')
depends=('libxrandr' 'libxft' 'libxcursor')
replaces=()
makedepends=('git' 'libxt')
optdepends=()
backup=()

source=(git+https://github.com/conformal/spectrwm)

md5sums=('SKIP')
provides=("spectrwm=${pkgver%%.r*}-${pkgrel}")
conflicts=('spectrwm')

pkgver() {
  ls -l >> log
  cd "$pkgname"
  git describe --long --tags | sed -E 's/^[^0-9]*//;s/([^-]*-g)/r\1/;s/[-_]/./g'
}

build() {
  cd "$srcdir/linux"
  make PREFIX="/usr" SYSCONFDIR="/etc"
}

package() {
  cd "$srcdir/$pkgname"
  cd linux
  make PREFIX="/usr" SYSCONFDIR="/etc" DESTDIR="$pkgdir" install
  cd ..
  install -Dm644 spectrwm.conf "$pkgdir/etc/spectrwm.conf"
  mkdir -p "$pkgdir/etc/spectrwm"
  cp spectrwm_*.conf "$pkgdir/etc/spectrwm/"
}
